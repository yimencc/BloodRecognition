[E 2021-10-07 14:38:35,811 train.py 313] CUDA error: device-side assert triggered
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 310, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 203, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 115, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 199, in __call__
    self.obj_loss = 5*self.object_loss() + self.non_object_loss()
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 102, in object_loss
    ious = compute_iou(x1, y1, w1, h1, x2, y2, w2, h2).unsqueeze(-1)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 28, in compute_iou
    union = w1 * h1 + w2 * h2 - inter
RuntimeError: CUDA error: device-side assert triggered
[E 2021-10-07 15:33:44,022 train.py 313] 'YoloLoss' object has no attribute 'class_loss'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 310, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 203, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 115, in train_loop
    loss        =   loss_fn(pred, y, ANCHORS)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 198, in __call__
    + weights["cls"] * self.class_loss()
AttributeError: 'YoloLoss' object has no attribute 'class_loss'
[E 2021-10-07 15:37:43,067 train.py 313] CUDA error: device-side assert triggered
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 310, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 203, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 115, in train_loop
    loss        =   loss_fn(pred, y, ANCHORS)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 199, in __call__
    + weights["obj"] * self.object_loss()
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 99, in object_loss
    ious = compute_iou(x1, y1, w1, h1, x2, y2, w2, h2).unsqueeze(-1)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 14, in compute_iou
    xmin1 = x1 - 0.5 * w1
RuntimeError: CUDA error: device-side assert triggered
[E 2021-10-07 16:09:10,685 train.py 313] CUDA error: device-side assert triggered
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 310, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 203, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 115, in train_loop
    loss        =   loss_fn(pred, y, ANCHORS)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 200, in __call__
    + weights["non_obj"] * self.non_object_loss())
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 112, in non_object_loss
    pred_wh_half = pred_wh / 2.
RuntimeError: CUDA error: device-side assert triggered
[E 2021-10-07 16:14:31,263 train.py 313] CUDA error: device-side assert triggered
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 310, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 203, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 115, in train_loop
    loss        =   loss_fn(pred, y, ANCHORS)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 199, in __call__
    + weights["obj"] * self.object_loss()
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 103, in object_loss
    obj_loss = torch.sum(self.mask*torch.square(ious-self.pred_conf))/(self.num_obj + 1e-6)
RuntimeError: CUDA error: device-side assert triggered
[E 2021-10-08 10:42:59,742 train.py 314] 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 226, in __call__
    pred = ModelOutput(y_pred, self.grid_size, self.anchors, self.n_classes, self.device)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 53, in __init__
    if len(anchors.shape) != 2:
AttributeError: 'list' object has no attribute 'shape'
[E 2021-10-08 10:44:16,596 train.py 314] Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 229, in __call__
    coord_loss  =   self.coordinate_loss(truth_xy=truth_xy, pred_xy=pred.xy, truth_wh=truth_wh,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 71, in xy
    return xy_grid + torch.sigmoid(xy_bias)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[E 2021-10-08 10:45:19,552 train.py 314] Expected target size (8, 40, 4, 4), got torch.Size([8, 40, 40, 4, 3])
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 232, in __call__
    class_loss  =   self.class_loss(truth_classes_oh=truth_classes_oh, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 122, in class_loss
    class_loss = loss(pred_classes, truth_classes_oh)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2397, in nll_loss
    raise ValueError("Expected target size {}, got {}".format(out_size, target.size()))
ValueError: Expected target size (8, 40, 4, 4), got torch.Size([8, 40, 40, 4, 3])
[E 2021-10-08 11:11:39,556 train.py 314] Expected target size (8, 40, 4, 3), got torch.Size([8, 40, 40, 4, 3])
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 232, in __call__
    class_loss  =   self.class_loss(truth_classes_oh=truth_classes_oh, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 122, in class_loss
    class_loss = loss(pred_classes, truth_classes_oh)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2397, in nll_loss
    raise ValueError("Expected target size {}, got {}".format(out_size, target.size()))
ValueError: Expected target size (8, 40, 4, 3), got torch.Size([8, 40, 40, 4, 3])
[E 2021-10-08 11:13:43,560 train.py 314] Expected target size (8, 40, 4, 3), got torch.Size([8, 40, 40, 4])
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 232, in __call__
    class_loss  =   self.class_loss(truth_classes_oh=truth_classes_oh, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 122, in class_loss
    class_loss = loss(pred_classes, true_box_class)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2397, in nll_loss
    raise ValueError("Expected target size {}, got {}".format(out_size, target.size()))
ValueError: Expected target size (8, 40, 4, 3), got torch.Size([8, 40, 40, 4])
[E 2021-10-08 11:33:52,917 train.py 314] unsupported operand type(s) for +: 'Tensor' and 'tuple'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 311, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 276, in execute
    self.training(lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 204, in training
    train_loop(self.train_loader, self.model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 116, in train_loop
    loss        =   loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 243, in __call__
    self.loss = w["coord"]*coord_loss + w["cls"]*class_loss + w["obj"]*object_loss + w["non_obj"]*nonobj_loss
TypeError: unsupported operand type(s) for +: 'Tensor' and 'tuple'
[E 2021-10-09 15:57:07,500 train.py 359] __init__() got an unexpected keyword argument 'class_loc'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 356, in <module>
    Training.training(y5Model, learnRate, trainLoader, validLoader, numEpochs, lossParams)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 172, in training
    loss_fn     =   YoloLoss(**loss_params)
TypeError: __init__() got an unexpected keyword argument 'class_loc'
[E 2021-10-09 16:05:28,935 train.py 359] __init__() got an unexpected keyword argument 'class_location'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 352, in <module>
    trainer = Training(lr=1e-4, loss_params={"device": DEVICE,
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 179, in __init__
    self.loss_fn = YoloLoss(**loss_params)
TypeError: __init__() got an unexpected keyword argument 'class_location'
[E 2021-10-09 16:06:12,417 train.py 359] __init__() missing 1 required positional argument: 'n_classes'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 352, in <module>
    trainer = Training(lr=1e-4, loss_params={"device": DEVICE,
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 179, in __init__
    self.loss_fn = YoloLoss(**loss_params)
TypeError: __init__() missing 1 required positional argument: 'n_classes'
[E 2021-10-09 16:07:08,817 train.py 360] 'BloodSmearDataset' object has no attribute 'dataset'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 357, in <module>
    trainer.training(5)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 186, in training
    train_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 108, in train_loop
    size = len(dataloader.dataset)
AttributeError: 'BloodSmearDataset' object has no attribute 'dataset'
[E 2021-10-09 16:09:42,588 train.py 363] The size of tensor a (4) must match the size of tensor b (0) at non-singleton dimension 0
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 360, in <module>
    trainer.training(5)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 187, in training
    train_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 117, in train_loop
    loss = loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 238, in __call__
    object_loss =   self.object_loss(gtruth_boxes=gTruth_boxes, truth_mask=truth_mask, truth_nobj=truth_nObj,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 145, in object_loss
    obj_loss = torch.sum(truth_mask*torch.square(ious-pred_conf))/(truth_nobj + 1e-6)
RuntimeError: The size of tensor a (4) must match the size of tensor b (0) at non-singleton dimension 0
[E 2021-10-09 16:22:18,320 train.py 363] The size of tensor a (4) must match the size of tensor b (0) at non-singleton dimension 0
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 360, in <module>
    trainer.training(5)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 187, in training
    train_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 117, in train_loop
    loss = loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 238, in __call__
    object_loss =   self.object_loss(gtruth_boxes=gTruth_boxes, truth_mask=truth_mask, truth_nobj=truth_nObj,
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 145, in object_loss
    obj_loss = torch.sum(truth_mask*torch.square(ious-pred_conf))/(truth_nobj + 1e-6)
RuntimeError: The size of tensor a (4) must match the size of tensor b (0) at non-singleton dimension 0
[E 2021-10-09 16:46:00,519 train.py 363] invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 360, in <module>
    trainer.training(5)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 187, in training
    train_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 117, in train_loop
    loss = loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 246, in __call__
    self.loss = w["coord"]*coord_loss + w["cls"]*class_loss + w["obj"]*obj_loss[0] + w["non_obj"]*nonobj_loss
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[E 2021-10-10 15:24:13,394 train.py 360] 
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 357, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 322, in execute
    self.training(self.model, self.train_loader, self.valid_loader, lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 252, in training
    train_loop(train_loader, model, loss_fn, optimizer, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 118, in train_loop
    loss = loss_fn(pred, y)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 230, in __call__
    pred = ModelOutput(y_pred, self.grid_size, self.anchors, self.n_classes, self.device)
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 56, in __init__
    self.assertion()
  File "D:\Workspace\RBC Recognition\Deeplearning\losses.py", line 64, in assertion
    assert self.data.shape[4] == 4 + 1 + self.n_classes
AssertionError
[E 2021-10-10 15:29:53,132 train.py 361] 'int' object has no attribute 'item'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 358, in <module>
    train_plan.execute(learning_rates=[3e-4], decay_rates=[0.03], patience=7)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 323, in execute
    self.training(self.model, self.train_loader, self.valid_loader, lr, decay_rate)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 256, in training
    valid_loss, acc = valid_loop(valid_loader, model, loss_fn)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 155, in valid_loop
    cur_acy = loss_fn.accuracy.item()
AttributeError: 'int' object has no attribute 'item'
[I 2021-10-14 14:58:33,250 train.py 280] Loading data...
[I 2021-10-14 14:59:19,480 train.py 280] Loading data...
[I 2021-10-14 15:01:28,443 train.py 279] Loading data...
[I 2021-10-14 15:02:42,239 train.py 279] Loading data...
[I 2021-10-14 15:04:13,207 train.py 279] Loading data...
[I 2021-10-14 15:06:06,994 train.py 279] Loading data...
[I 2021-10-14 15:06:36,277 train.py 279] Loading data...
[I 2021-10-14 15:07:03,139 train.py 202] Training Start
[I 2021-10-14 15:15:20,549 train.py 278] Loading data...
[I 2021-10-14 15:18:42,237 train.py 279] Loading data...
[I 2021-10-14 15:19:07,723 train.py 202] Training Start
[I 2021-10-14 15:27:24,993 train.py 280] Loading data...
[I 2021-10-14 15:27:52,105 train.py 203] Training Start
[I 2021-10-14 15:29:48,108 train.py 279] Loading data...
[I 2021-10-14 15:30:14,168 train.py 202] Training Start
[I 2021-10-14 15:30:39,734 train.py 279] Loading data...
[I 2021-10-14 15:30:47,562 train.py 279] Loading data...
[I 2021-10-14 15:31:11,095 train.py 202] Training Start
[I 2021-10-14 15:38:01,380 train.py 279] Loading data...
[I 2021-10-14 15:38:25,928 train.py 202] Training Start
[I 2021-10-14 15:47:50,902 train.py 278] Loading data...
[I 2021-10-14 15:47:58,630 train.py 278] Loading data...
[I 2021-10-14 15:48:25,053 train.py 201] Training Start

[I 2021-10-14 17:19:01,275 train.py 278] Loading data...
[I 2021-10-14 17:19:28,961 train.py 201] Training Start

[I 2021-10-15 12:14:53,486 train.py 311] Loading data...
[I 2021-10-15 12:15:24,662 train.py 232] Training Start

[I 2021-10-15 14:33:11,574 train.py 311] Loading data...
[I 2021-10-15 14:36:02,491 train.py 312] Loading data...
[I 2021-10-15 14:36:37,423 train.py 233] Training Start

[I 2021-10-15 16:33:38,435 train.py 312] Loading data...
[I 2021-10-15 16:34:15,125 train.py 233] Training Start

[I 2021-10-15 16:36:05,617 train.py 312] Loading data...
[I 2021-10-15 16:37:41,049 train.py 312] Loading data...
[I 2021-10-15 16:38:12,964 train.py 233] Training Start

[I 2021-10-15 16:48:20,122 train.py 312] Loading data...
[I 2021-10-15 16:48:53,587 train.py 233] Training Start

[I 2021-10-15 16:50:20,824 train.py 312] Loading data...
[I 2021-10-15 16:50:51,490 train.py 233] Training Start

[I 2021-10-15 17:15:42,222 train.py 216] Loading data ...
[I 2021-10-15 17:16:11,554 train.py 242] Training Start

[I 2021-10-15 17:17:04,523 train.py 216] Loading data ...
[I 2021-10-15 17:17:33,307 train.py 242] Training Start

[I 2021-10-15 17:20:02,515 train.py 216] Loading data ...
[I 2021-10-15 17:20:30,246 train.py 242] Training Start

[I 2021-10-19 15:49:18,655 train.py 215] Loading data ...
[I 2021-10-19 15:49:48,492 train.py 239] Training Start

[E 2021-10-19 15:49:49,422 train.py 329] The size of tensor a (4) must match the size of tensor b (40) at non-singleton dimension 3
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 327, in <module>
    trainer.training(100)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 275, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 128, in train_loop
    total_loss = loss_fn(pred, y) + reg_loss
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 247, in __call__
    obj_loss, accuracy = self.object_loss(gtruth_boxes=gTruth_boxes, truth_mask=truth_mask, truth_nobj=truth_nObj,
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 154, in object_loss
    obj_loss = torch.sum(truth_mask*torch.square(ious-pred_conf))/(truth_nobj + 1e-6)
RuntimeError: The size of tensor a (4) must match the size of tensor b (40) at non-singleton dimension 3
[I 2021-10-19 15:54:43,084 train.py 215] Loading data ...
[I 2021-10-19 15:55:12,626 train.py 239] Training Start

[I 2021-10-19 16:00:17,484 train.py 215] Loading data ...
[I 2021-10-19 16:00:47,742 train.py 239] Training Start

[E 2021-10-19 16:00:48,917 train.py 329] CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 4.00 GiB total capacity; 1.15 GiB already allocated; 3.55 MiB free; 1.19 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 327, in <module>
    trainer.training(100)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 275, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 128, in train_loop
    total_loss = loss_fn(pred, y) + reg_loss
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 250, in __call__
    non_obj_loss = self.non_object_loss(truth_boxes_grid=truth_boxes_grid, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 192, in non_object_loss
    union_area = pred_area + true_area - intersect_area
RuntimeError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 4.00 GiB total capacity; 1.15 GiB already allocated; 3.55 MiB free; 1.19 GiB reserved in total by PyTorch)
[I 2021-10-19 16:01:41,052 train.py 215] Loading data ...
[I 2021-10-19 16:02:11,102 train.py 239] Training Start

[E 2021-10-19 16:02:40,763 train.py 329] list indices must be integers or slices, not str
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 327, in <module>
    trainer.training(100)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 277, in training
    val_loss, accuracy = valid_loop(self.valid_loader, self.model, self.loss_fn, self.device)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 163, in valid_loop
    X, y = db_valid["modalities"].to(device), [item.to(device) for item in db_valid["labels"]]
TypeError: list indices must be integers or slices, not str
[I 2021-10-19 16:04:27,541 train.py 215] Loading data ...
[I 2021-10-19 16:04:57,896 train.py 239] Training Start

[I 2021-10-19 16:34:04,619 train.py 215] Loading data ...
[I 2021-10-19 16:34:33,953 train.py 239] Training Start

[I 2021-10-20 15:06:46,822 train.py 215] Loading data ...
[I 2021-10-20 15:07:18,351 train.py 239] Training Start

[I 2021-10-20 15:37:49,222 train.py 267] Early stopped at Accuracy 0.8079
[E 2021-11-01 14:54:01,487 train.py 329] __init__() missing 1 required positional argument: 'kernel_size'
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 326, in <module>
    trainer = Trainer(".\\hypers.yaml")
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 200, in __init__
    self.model          =   YoloV6Model(n_box, n_cls, grid_sz, attention).to(self.device)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 201, in __init__
    self.conv_7 = nn.Conv2d(256, self.n_box*(5+self.n_cls), **conv2d_params)
TypeError: __init__() missing 1 required positional argument: 'kernel_size'
[E 2021-11-01 15:08:26,210 train.py 329] name 'attention_layer' is not defined
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 326, in <module>
    trainer = Trainer(".\\hypers.yaml")
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 200, in __init__
    self.model          =   YoloV6Model(n_box, n_cls, grid_sz).to(self.device)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 181, in __init__
    self.attention_layer = attention_layer
NameError: name 'attention_layer' is not defined
[I 2021-11-01 15:12:39,888 train.py 215] Loading data ...
[I 2021-11-01 15:13:08,915 train.py 239] Training Start

[I 2021-11-01 15:18:08,787 train.py 215] Loading data ...
[I 2021-11-01 15:18:36,643 train.py 239] Training Start

[I 2021-11-01 15:57:39,933 train.py 167] Loading data ...
[I 2021-11-01 16:01:18,164 train.py 167] Loading data ...
[E 2021-11-01 16:01:46,841 train.py 281] Given groups=1, weight of size [8, 1, 3, 3], expected input[2, 4, 320, 320] to have 1 channels, but got 4 channels instead
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 279, in <module>
    trainer.training(100)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 223, in training
    self.on_train_begin(model_info=True)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 188, in on_train_begin
    summary(self.model, (4, 320, 320))
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torchsummary\torchsummary.py", line 72, in summary
    model(*x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 94, in forward
    x = self.conv_blocks(x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\container.py", line 119, in forward
    input = module(input)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 50, in forward
    x = self.conv(x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\conv.py", line 395, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [8, 1, 3, 3], expected input[2, 4, 320, 320] to have 1 channels, but got 4 channels instead
[I 2021-11-01 16:03:06,603 train.py 167] Loading data ...
[I 2021-11-01 16:03:20,670 train.py 191] Training Start

[I 2021-11-01 16:04:12,628 train.py 167] Loading data ...
[I 2021-11-01 16:04:19,355 train.py 191] Training Start

[I 2021-11-01 16:04:58,216 train.py 167] Loading data ...
[I 2021-11-01 16:05:04,646 train.py 191] Training Start

[I 2021-11-01 16:20:52,145 train.py 219] Early stopped at Accuracy 0.7965
[I 2021-11-02 11:24:41,733 train.py 167] Loading data ...
[E 2021-11-02 11:24:41,750 train.py 281] 0
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 278, in <module>
    trainer = Trainer(".\\hypers.yaml")
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 168, in __init__
    self.train_loader = create_dataloader(**hyp.get("train_loader_params")) if not train_loader else train_loader
  File "D:\Workspace\RBC Recognition\Deeplearning\util\dataset.py", line 852, in create_dataloader
    return DataLoader(batch_size=batch_size, dataset=dataset_obj(**constructor), **loader_params)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\dataset.py", line 794, in __init__
    self.dataset_scan()
  File "D:\Workspace\RBC Recognition\Deeplearning\util\dataset.py", line 802, in dataset_scan
    self.max_boxes = length[("train", "valid", "test").index(self.training_stage)]
KeyError: 0
[I 2021-11-02 11:30:36,524 train.py 167] Loading data ...
[I 2021-11-02 11:30:39,921 train.py 191] Training Start

[I 2021-11-02 15:50:36,124 train.py 168] Loading data ...
[E 2021-11-02 15:50:36,350 train.py 282] Given groups=1, weight of size [8, 4, 3, 3], expected input[2, 1, 320, 320] to have 4 channels, but got 1 channels instead
Traceback (most recent call last):
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 280, in <module>
    trainer.training(100)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 224, in training
    self.on_train_begin(model_info=True)
  File "D:/Workspace/RBC Recognition/Deeplearning/train.py", line 189, in on_train_begin
    summary(self.model, (1, 320, 320))
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torchsummary\torchsummary.py", line 72, in summary
    model(*x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 94, in forward
    x = self.conv_blocks(x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\container.py", line 119, in forward
    input = module(input)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 50, in forward
    x = self.conv(x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\conv.py", line 395, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [8, 4, 3, 3], expected input[2, 1, 320, 320] to have 4 channels, but got 1 channels instead
[I 2021-11-02 15:53:31,935 train.py 168] Loading data ...
[I 2021-11-02 15:53:34,871 train.py 192] Training Start

[I 2021-11-02 16:01:35,067 train.py 168] Loading data ...
[I 2021-11-02 16:01:36,185 train.py 192] Training Start

[I 2021-11-02 16:54:05,869 train.py 220] Early stopped at Accuracy 0.8066
[I 2021-11-03 11:15:12,523 train.py 168] Loading data ...
[I 2021-11-03 11:15:13,811 train.py 192] Training Start

[I 2021-11-03 11:15:46,100 train.py 168] Loading data ...
[I 2021-11-03 11:15:47,242 train.py 192] Training Start

[E 2021-11-03 11:15:47,869 train.py 282] Expected object of device type cuda but got device type cpu for argument #3 'weight' in call to _thnn_nll_loss2d_forward
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 280, in <module>
    trainer.training(100)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 228, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 82, in train_loop
    total_loss = loss_fn(pred, y) + reg_loss
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 288, in __call__
    class_loss = self.class_loss(truth_classes_oh=truth_classes_oh, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 178, in class_loss
    class_loss = loss(pred_scores, true_scores)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2413, in nll_loss
    out = torch._C._nn.nll_loss2d(input, target, weight, reduction_enum, ignore_index)
RuntimeError: Expected object of device type cuda but got device type cpu for argument #3 'weight' in call to _thnn_nll_loss2d_forward
[I 2021-11-03 11:16:34,005 train.py 168] Loading data ...
[I 2021-11-03 11:16:35,296 train.py 192] Training Start

[E 2021-11-03 11:16:35,850 train.py 282] Expected object of scalar type Float but got scalar type Long for argument #3 'weight' in call to _thnn_nll_loss2d_forward
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 280, in <module>
    trainer.training(100)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 228, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 82, in train_loop
    total_loss = loss_fn(pred, y) + reg_loss
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 287, in __call__
    class_loss = self.class_loss(truth_classes_oh=truth_classes_oh, truth_mask=truth_mask,
  File "D:\Workspace\RBC Recognition\Deeplearning\util\losses.py", line 177, in class_loss
    class_loss = loss(pred_scores, true_scores)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\functional.py", line 2413, in nll_loss
    out = torch._C._nn.nll_loss2d(input, target, weight, reduction_enum, ignore_index)
RuntimeError: Expected object of scalar type Float but got scalar type Long for argument #3 'weight' in call to _thnn_nll_loss2d_forward
[I 2021-11-03 11:16:53,405 train.py 168] Loading data ...
[I 2021-11-03 11:16:54,585 train.py 192] Training Start

[I 2021-11-03 11:17:30,003 train.py 168] Loading data ...
[I 2021-11-03 11:17:31,117 train.py 192] Training Start

[I 2021-11-03 11:17:50,324 train.py 168] Loading data ...
[I 2021-11-03 11:17:51,438 train.py 192] Training Start

[I 2021-11-03 12:05:42,839 train.py 220] Early stopped at Accuracy 0.8020
[I 2021-11-03 12:45:25,468 train.py 168] Loading data ...
[I 2021-11-03 12:45:26,630 train.py 192] Training Start

[I 2021-11-03 12:47:57,295 train.py 169] Loading data ...
[I 2021-11-03 12:47:58,420 train.py 193] Training Start

[I 2021-11-03 13:40:51,029 train.py 221] Early stopped at Accuracy 0.8065
[I 2021-11-09 15:39:30,378 train.py 169] Loading data ...
[I 2021-11-09 15:39:33,344 train.py 193] Training Start

[I 2021-11-09 16:38:12,640 train.py 221] Early stopped at Accuracy 0.8041
[I 2021-11-20 12:27:04,455 train.py 172] Loading data ...
[I 2021-11-20 12:29:08,187 train.py 172] Loading data ...
[E 2021-11-20 12:29:11,383 train.py 301] shape '[-1, 4, 8, 40, 40]' is invalid for input of size 112896
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 290, in <module>
    modelFilename = trainer.training(100)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 232, in training
    self.on_train_begin(model_info=True)
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 197, in on_train_begin
    summary(self.model, self.input_shape)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torchsummary\torchsummary.py", line 72, in summary
    model(*x)
  File "C:\Users\chenchao\Anaconda3\envs\torch18\lib\site-packages\torch\nn\modules\module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "D:\Workspace\RBC Recognition\Deeplearning\util\models.py", line 93, in forward
    x = x.reshape(-1, self.n_box, self.n_cls+5, self.gridsz, self.gridsz)
RuntimeError: shape '[-1, 4, 8, 40, 40]' is invalid for input of size 112896
[I 2021-11-20 12:30:27,367 train.py 172] Loading data ...
[I 2021-11-20 12:31:42,660 train.py 172] Loading data ...
[I 2021-11-20 12:37:05,174 train.py 172] Loading data ...
[I 2021-11-20 12:37:06,349 train.py 200] Training Start

[I 2021-11-20 12:37:41,024 train.py 172] Loading data ...
[I 2021-11-20 12:37:42,140 train.py 200] Training Start

[I 2021-11-20 13:47:36,001 train.py 228] Early stopped at Accuracy 0.7851
[E 2021-11-20 13:47:36,090 train.py 301] name 'logger' is not defined
Traceback (most recent call last):
  File "D:\Workspace\RBC Recognition\Deeplearning\train.py", line 299, in <module>
    set2021091.auto_verse_dl(modelFilename, predParams)
  File "D:\Workspace\RBC Recognition\Deeplearning\evaluate.py", line 338, in auto_verse_dl
    previous = self.dataset_predict(model_fpath, pred_params)
  File "D:\Workspace\RBC Recognition\Deeplearning\evaluate.py", line 328, in dataset_predict
    logger.info(f"Loading Model: {model_fpath} and Proceeding data ...")
NameError: name 'logger' is not defined
[I 2021-12-09 16:25:21,454 train.py 168] Loading data ...
[E 2021-12-09 16:25:21,454 train.py 298] [WinError 3] 系统找不到指定的路径。: 'D:\\Workspace\\RBC Recognition\\datasets\\Set-202109-1\\focus\\train'
Traceback (most recent call last):
  File "D:/Workspace/Whole Blood Recognition/Deeplearning/train.py", line 286, in <module>
    trainer = Trainer(".\\train_hypers.yaml", model_fpath=modelFpath)
  File "D:/Workspace/Whole Blood Recognition/Deeplearning/train.py", line 170, in __init__
    train_loader = create_dataloader(**self.hyp.get("train_loader_params"))
  File "D:\Workspace\Whole Blood Recognition\Deeplearning\util\dataset.py", line 1078, in create_dataloader
    return DataLoader(batch_size=batch_size, dataset=dataset_obj(**constructor), **loader_params)
  File "D:\Workspace\Whole Blood Recognition\Deeplearning\util\dataset.py", line 964, in __init__
    self.dataset_scan()
  File "D:\Workspace\Whole Blood Recognition\Deeplearning\util\dataset.py", line 989, in dataset_scan
    self.modality_dict = {mod: [f for f in listdir(join(self.root, mod, self.training_stage))
  File "D:\Workspace\Whole Blood Recognition\Deeplearning\util\dataset.py", line 989, in <dictcomp>
    self.modality_dict = {mod: [f for f in listdir(join(self.root, mod, self.training_stage))
FileNotFoundError: [WinError 3] 系统找不到指定的路径。: 'D:\\Workspace\\RBC Recognition\\datasets\\Set-202109-1\\focus\\train'
[I 2021-12-09 16:40:12,468 train.py 168] Loading data ...
[E 2021-12-09 16:40:12,468 train.py 298] [WinError 3] 系统找不到指定的路径。: 'D:\\Workspace\\Blood \\datasets\\Set-202109-1\\focus\\train'
Traceback (most recent call last):
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 286, in <module>
    trainer = Trainer(".\\train_hypers.yaml", model_fpath=modelFpath)
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 170, in __init__
    train_loader = create_dataloader(**self.hyp.get("train_loader_params"))
  File "D:\Workspace\Blood Recognition\Deeplearning\util\dataset.py", line 1078, in create_dataloader
    return DataLoader(batch_size=batch_size, dataset=dataset_obj(**constructor), **loader_params)
  File "D:\Workspace\Blood Recognition\Deeplearning\util\dataset.py", line 964, in __init__
    self.dataset_scan()
  File "D:\Workspace\Blood Recognition\Deeplearning\util\dataset.py", line 989, in dataset_scan
    self.modality_dict = {mod: [f for f in listdir(join(self.root, mod, self.training_stage))
  File "D:\Workspace\Blood Recognition\Deeplearning\util\dataset.py", line 989, in <dictcomp>
    self.modality_dict = {mod: [f for f in listdir(join(self.root, mod, self.training_stage))
FileNotFoundError: [WinError 3] 系统找不到指定的路径。: 'D:\\Workspace\\Blood \\datasets\\Set-202109-1\\focus\\train'
[I 2021-12-09 16:41:08,056 train.py 168] Loading data ...
[I 2021-12-09 16:41:11,976 train.py 196] Training Start

[E 2021-12-09 16:41:13,756 train.py 298] 
Traceback (most recent call last):
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 287, in <module>
    modelFilename = trainer.training(100)
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 232, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 82, in train_loop
    total_loss = loss_fn(pred, y)
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 279, in __call__
    pred = FeatureTranslator(y_pred, self.grid_size, self.anchors, self.n_classes, self.device)
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 108, in __init__
    self.assertion()
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 116, in assertion
    assert self.data.shape[3] == self.anchors.shape[0]
AssertionError
[I 2021-12-09 16:42:17,202 train.py 168] Loading data ...
[I 2021-12-09 16:42:19,221 train.py 196] Training Start

[I 2021-12-09 16:43:19,037 train.py 168] Loading data ...
[I 2021-12-09 16:43:20,433 train.py 196] Training Start

[E 2021-12-09 16:43:30,815 train.py 298] Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Traceback (most recent call last):
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 287, in <module>
    modelFilename = trainer.training(100)
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 232, in training
    tt_loss, md_loss, reg_loss = train_loop(self.train_loader, self.model, self.loss_fn, self.optimizer,
  File "D:/Workspace/Blood Recognition/Deeplearning/train.py", line 82, in train_loop
    total_loss = loss_fn(pred, y)
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 279, in __call__
    pred = FeatureTranslator(y_pred, self.grid_size, self.anchors, self.n_classes, self.device)
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 109, in __init__
    self._properties_translate()
  File "D:\Workspace\Blood Recognition\Deeplearning\util\losses.py", line 129, in _properties_translate
    self.wh = self.anchors * torch.exp(self.data[..., 2:4])
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[I 2021-12-09 16:44:22,109 train.py 168] Loading data ...
[I 2021-12-09 16:44:23,523 train.py 196] Training Start

[I 2021-12-09 16:47:39,164 train.py 168] Loading data ...
[I 2021-12-09 16:47:40,502 train.py 196] Training Start

[I 2021-12-09 21:09:25,350 train.py 168] Loading data ...
[I 2021-12-09 21:09:28,862 train.py 196] Training Start

[I 2021-12-09 21:27:44,567 train.py 168] Loading data ...
[I 2021-12-09 21:27:47,555 train.py 196] Training Start

